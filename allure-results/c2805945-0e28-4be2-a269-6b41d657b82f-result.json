{"name": "test_homepage[chromium]", "status": "failed", "statusDetails": {"message": "Failed: Screenshots differ by 18694 pixels", "trace": "screenshot_helper = <conftest.screenshot_helper.<locals>.ScreenshotHelper object at 0x7f1b9aec8460>, page = <Page url='https://river-travel.ru/'>\n\n    def test_homepage(screenshot_helper, page):\n        page.goto(\"https://river-travel.ru\")\n>       screenshot_helper.take_and_compare(\"homepage\")\n\nriver-travel.ru/test_river_travel.py:5: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <conftest.screenshot_helper.<locals>.ScreenshotHelper object at 0x7f1b9aec8460>, name = 'homepage', full_page = True, threshold = 0.1\n\n    def take_and_compare(self, name: str, full_page=True, threshold=0.1):\n        reference_filename = self._get_filename(name, \"reference\")\n        actual_filename = self._get_filename(name, \"actual\")\n        diff_filename = self._get_filename(name, \"diff\")\n    \n        reference_path = os.path.join(self.reference_dir, reference_filename)\n        actual_path = os.path.join(self.actual_dir, actual_filename)\n        diff_path = os.path.join(self.diff_dir, diff_filename)\n    \n        # Делаем актуальный скриншот\n        page.screenshot(path=actual_path, full_page=full_page)\n    \n        # Прикрепляем actual скриншот к отчету\n        allure.attach.file(actual_path, name=\"Actual screenshot\",\n                         attachment_type=AttachmentType.PNG)\n    \n        # Если нет эталонного - сохраняем и прикрепляем\n        if not os.path.exists(reference_path):\n            page.screenshot(path=reference_path, full_page=full_page)\n            allure.attach.file(reference_path, name=\"Reference screenshot (created)\",\n                              attachment_type=AttachmentType.PNG)\n            pytest.skip(f\"Reference screenshot created: {reference_path}\")\n            return True\n    \n        # Прикрепляем reference скриншот\n        allure.attach.file(reference_path, name=\"Reference screenshot\",\n                         attachment_type=AttachmentType.PNG)\n    \n        # Сравниваем изображения\n        img_ref = Image.open(reference_path)\n        img_actual = Image.open(actual_path)\n    \n        if img_ref.size != img_actual.size:\n            allure.attach(\"Screenshot sizes differ\", name=\"Comparison error\")\n            raise ValueError(f\"Screenshot sizes differ: {img_ref.size} vs {img_actual.size}\")\n    \n        # Быстрая проверка без создания diff\n        mismatch = pixelmatch(img_ref, img_actual, None, threshold=threshold, includeAA=True)\n    \n        # Если есть различия - создаем и прикрепляем diff\n        if mismatch > 0:\n            diff_img = Image.new(\"RGBA\", img_ref.size)\n            pixelmatch(img_ref, img_actual, diff_img, threshold=threshold, includeAA=True)\n            diff_img.save(diff_path)\n    \n            # Прикрепляем diff изображение\n            allure.attach.file(diff_path, name=\"Difference highlight\",\n                             attachment_type=AttachmentType.PNG)\n    \n            # Добавляем текстовую информацию о различиях\n            allure.attach(f\"Found {mismatch} differing pixels (threshold: {threshold})\",\n                        name=\"Difference details\")\n    \n>           pytest.fail(f\"Screenshots differ by {mismatch} pixels\")\nE           Failed: Screenshots differ by 18694 pixels\n\nconftest.py:82: Failed"}, "attachments": [{"name": "Actual screenshot", "source": "f96d15c5-2f9f-446e-a795-5017ff4df39a-attachment.png", "type": "image/png"}, {"name": "Reference screenshot", "source": "0f4bd9ca-05a4-452a-a86c-aaebf45533de-attachment.png", "type": "image/png"}, {"name": "Difference highlight", "source": "45685268-9958-434f-9613-16f8aafbb422-attachment.png", "type": "image/png"}, {"name": "Difference details", "source": "53a8e5fa-1a7f-41c8-90f4-b5c5de5b336d-attachment.attach"}], "parameters": [{"name": "browser_name", "value": "'chromium'"}], "start": 1748376190546, "stop": 1748376321255, "uuid": "0ae84069-006a-4fb7-84a0-c9e2649af3c9", "historyId": "1bf6f2a94369588780dbc47851d0b8af", "testCaseId": "41f85ffe570457442eef359916025c9d", "fullName": "river-travel.ru.test_river_travel#test_homepage", "labels": [{"name": "parentSuite", "value": "river-travel.ru"}, {"name": "suite", "value": "test_river_travel"}, {"name": "host", "value": "yfy5pf"}, {"name": "thread", "value": "18380-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "river-travel.ru.test_river_travel"}]}